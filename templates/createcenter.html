{% extends 'home.html' %}
{% block stage %}
<!--content-->
<div class="container form-client">
  <div class="col-lg-offset-1 col-lg-3 col-lg-offset-3 form-client">
    <fieldset>
      <legend>Create Center</legend>
      <form class="form-horizontal" role="form" method="post" id="createcenterform">
      {% csrf_token %}
        <div class="user-form">
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-4 control-label">Name <span>*</span></label>
            <div class="col-sm-8">
              <input type="text" class="form-control query-style" id="inputEmail3" name="name" required="True">
              <div id="nameerror">
          </div>
            </div>
          </div>
          <!--add groups-->
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-4 control-label">Add Groups <span>*</span></label>
            <div class="col-sm-8">
              <div class="inner-div">
                <div class="table-group">
                  <div class="table-responsive my-table">
                    <table class="table table-bordered">
                      <tbody>
                        <tr>
                          <th>Select</th>
                          <th>Name</th>
                          <th>Branch</th>
                        </tr>
                        {% for group in groups %}
                        <tr>
                          <th><input type="checkbox" name="groups" value="{{ group.id }}"></td>
                          <td>{{group.name}}</td>
                          <td>{{group.branch.name}}</td>
                        </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                    <div id="addgrouperror">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- add client ends above-->
        </div>
        <div class="user-form">
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-4 control-label">Branch <span>*</span></label>
            <div class="col-sm-8">
              <select class="form-control query-style" name="branch" required="True">
                <option>Select Branch</option>
                {% for branch in branches %}
                <option value="{{ branch.id }}">{{ branch.name }}</option>
                {% endfor %}
              </select>
              <div id="brancherror">
          </div>
            </div>
          </div>
          <div class="form-group">
            <label for="inputEmail3" class="col-sm-4 control-label">Activation date <span>*</span></label>
            <div class="col-sm-8">
              <input type="text" class="form-control query-style" id="dateepicker" name="created_date" required="True">
              <div id="activationdateerror">
            </div>
            </div>
          </div>
        </div>
        <br clear="all" />
        <div class="user-form-footer">
          <div class="form-group">
            <div class="col-sm-offset-4 col-sm-8">
              <i class="fa fa-check submit-icon"></i>
              <input type="submit" value="Submit"  class="submit-btn" >
              <i class="fa fa-times submit-icon"></i>
              <input type="reset" value="Cancel"  class="cancel-btn" >
            </div>
          </div>
        </div>
      </form>
    </fieldset>
  </div>
</div>
<!--content-->
<script src="/static/js/my-script.js"></script>
<script type="text/javascript">
  $(".submit-btn").click(function(e) {
    e.preventDefault();
    $.post("/createcenter/", $("form#createcenterform").serialize(), function(data) {
      if (data.error){
        $("p.error").remove();
        if (data.message.name){$("#nameerror").prepend("<p class='error'>"+data.message.name+"</p>"+"<br>");}
        if (data.message.created_date){$("#activationdateerror").prepend("<p class='error'>"+data.message.created_date+"</p>"+"<br>");}
        if (data.message.branch){$("#brancherror").prepend("<p class='error'>"+data.message.branch+"</p>"+"<br>");}
        if (data.message.groups){$("#addgrouperror").prepend("<p class='error'>"+data.message.groups+"<br>"+"</p>");}
      }else{
        window.location = '/centerprofile/'+data.center_id+'/';
      }
      
      
    }, 'json');
    
  });
  
</script>
{% endblock %}